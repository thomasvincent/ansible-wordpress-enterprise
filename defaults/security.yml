---
# WordPress Enterprise - Security Hardening Default Variables

# Main security settings
wordpress_security_hardening_enabled: true
wordpress_security_validate: true
wordpress_security_status_script: true
wordpress_security_cron: true

# SELinux configuration (RHEL/CentOS)
wordpress_selinux_enabled: true
wordpress_selinux_mode: enforcing
wordpress_selinux_enforce: true
wordpress_selinux_audit: true
wordpress_selinux_validate: true
wordpress_selinux_custom_policy: false

# SELinux booleans
wordpress_selinux_httpd_can_network_connect: true
wordpress_selinux_httpd_can_network_connect_db: true
wordpress_selinux_httpd_execmem: false
wordpress_selinux_httpd_unified: false
wordpress_selinux_httpd_builtin_scripting: true
wordpress_selinux_httpd_enable_cgi: true
wordpress_selinux_httpd_can_sendmail: true
wordpress_selinux_httpd_read_user_content: true
wordpress_selinux_httpd_enable_homedirs: false

# AppArmor configuration (Ubuntu/Debian)
wordpress_apparmor_enabled: true
wordpress_apparmor_install: true
wordpress_apparmor_mode: enforce  # enforce or complain
wordpress_apparmor_audit: true
wordpress_apparmor_validate: true
wordpress_apparmor_notify: true
wordpress_apparmor_load_profiles: true

# AppArmor profiles
wordpress_apparmor_php_profile: true
wordpress_apparmor_nginx_profile: true
wordpress_apparmor_apache_profile: true
wordpress_apparmor_wpcli_profile: true

# File permissions and security
wordpress_secure_uploads: true
wordpress_user: www-data
wordpress_group: www-data

# Security tools and monitoring
wordpress_install_security_tools: true
wordpress_fail2ban_enabled: true
wordpress_auto_security_updates: true
wordpress_disable_unused_services: true
wordpress_kernel_hardening: true
wordpress_password_policy: true

# Logging paths (can be overridden per web server)
wordpress_access_log_path: "{{
  '/var/log/nginx/access.log' if wordpress_web_server == 'nginx'
  else '/var/log/apache2/access.log' if ansible_os_family == 'Debian'
  else '/var/log/httpd/access_log'
}}"

# Fail2ban configuration
wordpress_fail2ban_maxretry: 3
wordpress_fail2ban_findtime: 120
wordpress_fail2ban_bantime: 1200
